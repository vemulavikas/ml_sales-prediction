# Sales Forecast Assignment - ML Deliverables Only

This folder contains **only the Machine Learning deliverables** for the assignment.

## Files in this folder

- `train_lstm.py`  
  - Loads the weekly assignment dataset `Assignment-3-ML-Sales_Transactions_Dataset_Weekly.csv`.
  - Converts it into a 2-feature time series (total weekly sales + mean normalized value).
  - Trains an LSTM model with lookback 12 and saves artifacts into `model_dir/`:
    - `lstm_saved_model/` – TensorFlow SavedModel.
    - `scaler.pkl` – MinMaxScaler used for scaling the time series.
    - `metadata.json` – training configuration and validation metrics.

- `predict_lstm.py`  
  - Loads the trained model and scaler from `model_dir/`.
  - Reads the same dataset format as training.
  - Generates multi-step forecasts and outputs either JSON (via CLI) or a pandas DataFrame (via `forecast_to_dataframe`).

- `visualize_forecast.py`  
  - Convenience script for the ML part.
  - Uses `predict_lstm.py` to get forecasts.
  - Prints a forecast grid and shows/saves a bar chart with `matplotlib`.

These three scripts together implement your **ML role**: data preparation, model training, forecasting, and basic visualization.

## Required external files

The following files are **used by the ML code** but live outside this folder:

- Training data (provided in the assignment):
  - `Assignment-3-ML-Sales_Transactions_Dataset_Weekly.csv`

- Trained model artifacts (already generated by `train_lstm.py`):
  - `model_dir/` at the project root, containing:
    - `lstm_saved_model/`
    - `scaler.pkl`
    - `metadata.json`

Your teammates can re-train the model or reuse the existing `model_dir`.

## How to train the model (ML part)

From the project root (for example, `D:\Aspyr`):

```bash
py -3.10 submission_ml_only/train_lstm.py \
  --input Assignment-3-ML-Sales_Transactions_Dataset_Weekly.csv \
  --model_out model_dir \
  --epochs 50
```

This will store the trained model and metadata in `model_dir/`.

## How to generate forecasts (ML part)

CLI JSON output:

```bash
py -3.10 submission_ml_only/predict_lstm.py \
  --model_dir model_dir \
  --history Assignment-3-ML-Sales_Transactions_Dataset_Weekly.csv \
  --predict_months 12 \
  --out test_forecast.json
```

Local visualization for the report:

```bash
py -3.10 submission_ml_only/visualize_forecast.py \
  --model_dir model_dir \
  --history Assignment-3-ML-Sales_Transactions_Dataset_Weekly.csv \
  --predict_months 52 \
  --out_image forecast_1year.png
```

## Model accuracy (for your ML discussion)

From the latest training run on the weekly dataset:

- Validation MAE: ~63.37 units
- Validation RMSE: ~81.84 units
- Validation MAPE: ~0.90 %

This means the average error on the last 12 weeks is less than 1% of actual total sales, which is very accurate for this dataset.

> Note: Any backend REST API or UI files (FastAPI, HTML/JS) are **not** included here, since your role is the ML part. They are kept separately in the main `submission/` folder as optional integration helpers.
